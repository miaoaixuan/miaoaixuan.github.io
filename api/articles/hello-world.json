{"title":"NewStarCTF2023 Week1 WP","uid":"480d6760ce5e67b6df1ab2f07261fd87","slug":"hello-world","date":"2023-10-17T17:00:19.387Z","updated":"2023-10-18T05:25:42.802Z","comments":true,"path":"api/articles/hello-world.json","keywords":null,"cover":[],"content":"<p>主要做了Crypto和Misc部分</p>\n<h2 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h2><h2 id=\"Crypto\"><a href=\"#Crypto\" class=\"headerlink\" title=\"Crypto\"></a>Crypto</h2><h3 id=\"babyaes\"><a href=\"#babyaes\" class=\"headerlink\" title=\"babyaes\"></a>babyaes</h3><p>题目</p>\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">from</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Crypto.Cipher</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">AES</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">os</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">from</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">flag</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">flag</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">from</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Crypto.Util.number</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8\">*</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">pad</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">data</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">data</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">+</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span><span style=\"color: #89DDFF\">&quot;&quot;</span><span style=\"color: #C3E88D\">.join</span><span style=\"color: #89DDFF\">([</span><span style=\"color: #BABED8\">b</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">\\x00</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> _ </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range(</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #BABED8\">, </span><span style=\"color: #F78C6C\">16</span><span style=\"color: #BABED8\"> - len(data))</span><span style=\"color: #89DDFF\">])</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">main</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">flag_</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">pad</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">flag</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">key</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">os.urandom</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">16</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">2</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">iv</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">os.urandom</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">16</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(bytes_to_long(key) ^ bytes_to_long</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">iv</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> ^ 1)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">aes</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">AES.new</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">key,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">AES.MODE_CBC,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">iv</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">enc_flag</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">aes.encrypt</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">flag_</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(enc_flag)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">__name__</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">__main__</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">main</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\"># b&#39;&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i&#39;</span></span></code></pre></div><p>wp</p>\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">from</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Crypto.Cipher</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">AES</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">os</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">from</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">gmpy2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">import</span><span style=\"color: #BABED8\">*</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">from</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Crypto.Util.number</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">import</span><span style=\"color: #BABED8\">*</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">xor</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3657491768215750635844958060963805125333761387746954618540958489914964573229</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">enc_flag</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">&gt;]\\xc1\\xe5\\x82/\\x02\\x7ft\\xf1B\\x8d\\n\\xc1\\x95i</span><span style=\"color: #89DDFF\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">out</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">long_to_bytes</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">xor</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">key</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">out[:16]</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">2</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># print(key)</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">iv</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">bytes_to_long</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">key[16:]</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">^bytes_to_long</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">out[16:]</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># print(iv)</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">iv</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">long_to_bytes</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">iv</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># print(iv)</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">aes</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">AES.new</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">key,AES.MODE_CBC,iv</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">flag</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">aes.decrypt</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">enc_flag</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(flag)</span></span></code></pre></div><p>flag<br>flag{firsT_cry_Aes}  </p>\n<h3 id=\"Caesar’s-Secert\"><a href=\"#Caesar’s-Secert\" class=\"headerlink\" title=\"Caesar’s Secert\"></a>Caesar’s Secert</h3><p>题目<br>kqfl{hf3x4w’x_h1umjw_n5_a4wd_3fed}<br>wp<br>普通的凯撒加密，尝试可知位移为5，可得flag<br><br /><img src=\"https://ooo.0x0.ooo/2023/10/18/O7eWHB.png\" alt=\"image.png\"><br>flag<br>flag{ca3s4r’s_c1pher_i5_v4ry_3azy}</p>\n","text":"主要做了Crypto和Misc部分 MiscCryptobabyaes题目 bashfrom Crypto.Cipher import AES import o...","permalink":"/post/hello-world","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Misc\"><span class=\"toc-text\">Misc</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Crypto\"><span class=\"toc-text\">Crypto</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#babyaes\"><span class=\"toc-text\">babyaes</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Caesar%E2%80%99s-Secert\"><span class=\"toc-text\">Caesar’s Secert</span></a></li></ol></li></ol>","author":{"name":"泠鹇","slug":"blog-author","avatar":"https://ooo.0x0.ooo/2023/10/18/O7eo56.jpg","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{}}